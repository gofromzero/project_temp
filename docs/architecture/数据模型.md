# 数据模型

## Tenant (租户)

**目的：** 表示系统中的租户组织，实现多租户数据隔离

**关键属性：**
- id: string - 租户唯一标识符
- name: string - 租户名称
- code: string - 租户代码（用于子域名等）
- status: TenantStatus - 租户状态（活跃/暂停/禁用）
- config: TenantConfig - 租户配置信息
- createdAt: Date - 创建时间
- updatedAt: Date - 更新时间

### TypeScript接口

```typescript
interface Tenant {
  id: string;
  name: string;
  code: string;
  status: 'active' | 'suspended' | 'disabled';
  config: {
    maxUsers: number;
    features: string[];
    theme?: string;
    domain?: string;
  };
  adminUserId?: string;
  createdAt: Date;
  updatedAt: Date;
}

enum TenantStatus {
  Active = 'active',
  Suspended = 'suspended', 
  Disabled = 'disabled'
}
```

### 关系
- 一对多：一个租户可以有多个用户
- 一对一：一个租户有一个管理员用户

## User (用户)

**目的：** 表示系统用户，支持系统管理员和租户用户两种角色

**关键属性：**
- id: string - 用户唯一标识符
- tenantId: string - 所属租户ID（系统管理员为空）
- username: string - 用户名
- email: string - 邮箱地址
- hashedPassword: string - 加密后的密码
- roles: Role[] - 用户角色列表
- profile: UserProfile - 用户资料
- status: UserStatus - 用户状态

### TypeScript接口

```typescript
interface User {
  id: string;
  tenantId?: string; // 为空表示系统管理员
  username: string;
  email: string;
  hashedPassword: string;
  roles: Role[];
  profile: {
    firstName: string;
    lastName: string;
    avatar?: string;
    phone?: string;
  };
  status: 'active' | 'inactive' | 'locked';
  lastLoginAt?: Date;
  createdAt: Date;
  updatedAt: Date;
}
```

### 关系
- 多对一：多个用户属于一个租户
- 多对多：用户可以有多个角色

## Role (角色)

**目的：** 定义用户角色和权限集合，实现RBAC权限控制

**关键属性：**
- id: string - 角色唯一标识符
- tenantId: string - 所属租户ID（系统角色为空）
- name: string - 角色名称
- code: string - 角色代码
- permissions: Permission[] - 权限列表
- isSystem: boolean - 是否为系统内置角色

### TypeScript接口

```typescript
interface Role {
  id: string;
  tenantId?: string; // 为空表示系统角色
  name: string;
  code: string;
  description?: string;
  permissions: Permission[];
  isSystem: boolean;
  createdAt: Date;
  updatedAt: Date;
}
```

### 关系
- 多对多：角色可以分配给多个用户
- 多对多：角色可以包含多个权限

## Permission (权限)

**目的：** 定义系统中的具体权限点，支持细粒度访问控制

**关键属性：**
- id: string - 权限唯一标识符
- name: string - 权限名称
- code: string - 权限代码
- resource: string - 资源名称
- action: string - 操作类型
- scope: PermissionScope - 权限范围

### TypeScript接口

```typescript
interface Permission {
  id: string;
  name: string;
  code: string; // 如：tenant.create, user.read
  resource: string; // 如：tenant, user, role
  action: string; // 如：create, read, update, delete
  scope: 'system' | 'tenant' | 'self';
  description?: string;
  isSystem: boolean;
}
```

### 关系
- 多对多：权限可以分配给多个角色

## AuditLog (审计日志)

**目的：** 记录系统中的重要操作，用于审计和监控

**关键属性：**
- id: string - 日志唯一标识符
- tenantId: string - 租户ID
- userId: string - 操作用户ID
- action: string - 操作类型
- resource: string - 操作资源
- details: object - 操作详情
- timestamp: Date - 操作时间

### TypeScript接口

```typescript
interface AuditLog {
  id: string;
  tenantId?: string;
  userId: string;
  action: string; // create, update, delete, login, logout
  resource: string; // user, tenant, role, permission
  resourceId?: string;
  details: {
    before?: any;
    after?: any;
    metadata: Record<string, any>;
  };
  ipAddress?: string;
  userAgent?: string;
  timestamp: Date;
}
```

### 关系
- 多对一：多个日志记录属于一个租户
- 多对一：多个日志记录属于一个用户

---
